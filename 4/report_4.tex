\documentclass[a4paper,11pt]{ltjsarticle}
\usepackage{geometry}
\geometry{top=25mm,bottom=25mm,left=25mm,right=25mm}
\usepackage{graphicx}
\usepackage{amsmath,amssymb,bm}
\usepackage{hyperref}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{physics}
\usepackage{microtype}

\hypersetup{
  pdftitle={数理工学実験レポート},
  pdfauthor={中塚一瑳},
  colorlinks=true,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue
}

% -------------------------
% ユーザ定義マクロ
% -------------------------
\newcommand{\StudentID}{1029366161}
\newcommand{\AuthorName}{中塚一瑳}
\newcommand{\CourseName}{数理工学実験}
\newcommand{\ChapterTitle}{第4章（モンテカルロシミュレーション）}
\newcommand{\ExperimentDate}{\today}

% 図・表フォルダパス（必要なら変更）
\newcommand{\graphdir}{graphs}

% 数式用の簡易マクロ
\newcommand{\R}{\mathbb{R}}
% \newcommand{\norm}[1]{\left\lVert#1\right\rVert}

% listings 設定（Julia を例示）
\lstset{
  basicstyle=\ttfamily\footnotesize,
  breaklines=true,
  frame=single,
  numbers=left,
  numberstyle=\tiny,
  language=Python,
  keywordstyle=\color{blue},
  commentstyle=\color{gray},
  stringstyle=\color{teal},
  showstringspaces=false
}



% キャプションのフォント調整
\captionsetup{font=small,labelfont=bf}

% -------------------------
% 本文
% -------------------------
\title{数理工学実験レポート\\[4pt]\large \ChapterTitle}
\author{学籍番号 1029366161 \quad 中塚一瑳}
\date{\ExperimentDate}

\begin{document}

\maketitle
\begin{abstract}
% 要旨をここに記述
\end{abstract}

\tableofcontents
\clearpage



% ===== 例：実験テンプレート =====
\section*{はじめに}
今回はモンテカルロ法を用いた数値計算手法について学ぶ。伝染モデルや円周率のモンテカルロ法シミュレーションを行い、さらにイジングモデルに対して熱浴法とメトロポリス法を実装し、その性能を比較する。問題の条件を満たしながら、pythonで効率的なコードを実装することを目指す。


\section{課題1：疫病の確率的な伝染モデル}

\input{task1.tex}


\section{課題2：モンテカルロ法による円周率推定}

\input{task2.tex}

\section{課題3：熱よく法とメトロポリス法のつり合い条件の証明}
\input{task3.tex}

\section{課題4：熱よく法によるイジングモデルのシミュレーション}
\input{task4.tex}
% ===== 結論 =====
\section*{結論}
本実験では、モンテカルロ法を用いた数値計算手法について学んだ。疫病の確率的な伝染モデルをシミュレーションし、感染拡大の様子を観察した。また、円周率のモンテカルロ法による推定を行い、サンプル数の増加に伴う推定精度の向上を確認した。さらに、イジングモデルに対して熱浴法とメトロポリス法を実装し、磁化の期待値と系サイズ・温度依存性を比較した。
実装においては、Pythonのベクトル化やGPU並列計算を活用し、計算効率を大幅に改善した。これにより、大規模なシミュレーションが現実的な時間内で実行可能となった。今後は、さらに高度なモンテカルロ手法や他の物理モデルへの応用を検討したい。

% ===== 付録 =====
\appendix
\section{ソースコード}
コード作成、レポート作成の一部にGitHub Copilotを使用した。
\subsection{課題1のコード}
\subsubsection{小問1}
\lstinputlisting[language=Python, caption=課題1-1のコード]{task1_1.py}

\subsubsection{小問2}
\lstinputlisting[language=Python, caption=課題1-2のコード]{task1_2.py}

\subsection{課題2のコード}
\lstinputlisting[language=Python, caption=課題2のコード]{task2_1.py}

\subsection{課題4のコード}
\subsubsection{熱浴法}
\lstinputlisting[language=Python, caption=課題4-2 熱浴法のコード]{task4_2_heat.py}

\subsubsection{メトロポリス法}
\lstinputlisting[language=Python, caption=課題4-2 メトロポリス法のコード]{task4_2_metro.py}

\subsubsection{複数温度の並列シミュレーション}
\lstinputlisting[language=Python, caption=課題4-3のコード]{task4_3.py}


% ===== 参考文献 =====
\section*{参考文献}
\begin{thebibliography}{9}
\bibitem{exp2025} 数理工学実験（2025年度配布資料）.
\end{thebibliography}

\end{document}
