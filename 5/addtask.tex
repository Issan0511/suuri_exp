
\[
\min_{x\in\mathbb{R}^n}\ \frac12 x^\top Qx + c^\top x
\quad \text{subject to}\quad Ax \le b,
\]
ただし $Q$ は対称半正定値行列とする。
\subsection{課題1}
二次計画問題として定式化することが自然な問題の一つに、最小二乗法による制約付き回帰問題がある。
与えられたデータ点 $(a_i,y_i)\in\mathbb{R}^n\times\mathbb{R}$ $(i=1,\dots,m)$ に対し、
\[
\min_{x\in\mathbb{R}^n}\ \frac12 \sum_{i=1}^m (y_i - a_i^\top x)^2
\quad \text{subject to}\quad Ax \le b
\]
を解くことで、線形モデル $y \approx a^\top x$ のパラメータ $x$ を求めることができる。
この問題は、行列 $A\in\mathbb{R}^{m\times n}$、ベクトル $c\in\mathbb{R}^m$ を用いて
\[\min_{x\in\mathbb{R}^n}\ \frac12 \|Ax - y\|^2 = \min_{x\in\mathbb{R}^n}\ \frac12 x^\top (A^\top A) x - y^\top A x + \frac12 y^\top y\]
と変形でき、$Q=A^\top A$、$c=-A^\top y$ とすれば二次計画問題の形に帰着できる。
\subsection{課題2}
課題3で後ほど説明するように、Qが半正定値である場合はKKT条件と内点法を用いて最適解を求めることができる。しかし、Qが正定値でない、例えばQの固有値に1つでも負の値がある場合は、KKT条件を満たす点が最適解とは限らず、NP困難な問題となることが知られている。\cite{pardalos1991}\cite{sahni1974}。
\subsection{課題3}


本課題では， University of California, Irvine の\href{https://www.math.uci.edu/~qnie/Publications/NumericalOptimization.pdf}{Numerical Optimization} のチャプター16.6 "INTERIOR-POINT METHODS"を参考に，内点法を実装した。
文献で扱われている $Ax\ge b$ の形式に合わせるため，
\[
Ax\le b \;\;\Longleftrightarrow\;\; (-A)x \ge (-b)
\]
と左右反転し，$\tilde A=-A,\ \tilde b=-b$ を用いて
\[
\tilde A x \ge \tilde b
\]
として以下を進める（記号の簡略化のため，再び $A,b$ と書く）。

制約 $Ax\ge b$ に対し，スラック変数 $y\ge0$ を導入すると，
\[
Ax-y-b=0
\]
と書ける。これに対する KKT 条件は
\[
\begin{cases}
Qx-A^\top\lambda+c=0,\\
Ax-y-b=0,\\
y_i\lambda_i=0\quad (i=1,\dots,m),\\
y\ge0,\ \lambda\ge0
\end{cases}
\]
である。問題は凸であるため，これらの条件は必要十分である。

相補性条件 $y_i\lambda_i=0$ は境界条件であり直接扱いにくいため，
補完性の平均尺度
\[
\mu=\dfrac{y^\top\lambda}{m}
\]
を導入し，摂動 KKT 系
\[
F(x,y,\lambda;\sigma\mu)=
\begin{pmatrix}
Qx-A^\top\lambda+c\\
Ax-y-b\\
Y\Lambda e-\sigma\mu e
\end{pmatrix}
=0
\]
を考える。ここで
$Y=\mathrm{diag}(y_1,\dots,y_m)$，
$\Lambda=\mathrm{diag}(\lambda_1,\dots,\lambda_m)$，
$e=(1,\dots,1)^\top$，
$\sigma\in(0,1)$ は固定定数である。
$\sigma\mu>0$ の解は central path を成し，$\sigma\mu\to0$ により
元の KKT 解（最適解）に収束する。

現在の反復点 $z=(x,y,\lambda)$ において，
Newton 法により
\[
F(z+\Delta z)\approx F(z)+J_F(z)\Delta z=0
\]
を解く。ヤコビ行列は
\[
J_F(z)=
\begin{pmatrix}
Q & 0 & -A^\top\\
A & -I & 0\\
0 & \Lambda & Y
\end{pmatrix}
\]
であり，Newton 方程式は
\[
\begin{pmatrix}
Q & 0 & -A^\top\\
A & -I & 0\\
0 & 0 & Y
\end{pmatrix}
\begin{pmatrix}
\Delta x\\
\Delta y\\
\Delta\lambda
\end{pmatrix}
=
\begin{pmatrix}
-r_d\\
-r_p\\
-\Lambda Y e+\sigma\mu e
\end{pmatrix}
\]
となる。ここで
\[
r_d=Qx-A^\top\lambda+c,\qquad
r_p=Ax-y-b
\]
はそれぞれ双対残差および主残差である。

得られた方向に対して
\[
(x^+,y^+,\lambda^+)=(x,y,\lambda)+\alpha(\Delta x,\Delta y,\Delta\lambda)
\]
と更新する。ただし $y^+>0,\ \lambda^+>0$ を保つように
$\alpha\in(0,1]$ を選ぶ。

以上を反復し，
$\|r_p\|,\ \|r_d\|,\ \mu$ が十分小さくなった時点で停止する。
凸性より，停止点 $x$ は元の制約 $Ax\le b$ を満たす
二次計画問題の最適解である。


\subsection{課題４}

本課題では，以下のデータを用いて内点法を実装し，制約付き二次計画問題を解いた。
\[Q=\begin{pmatrix}
2 & 0\\ 
0 & 1
\end{pmatrix},\quad
c=\begin{pmatrix}
-1 \\ -1
\end{pmatrix},\quad
A=\begin{pmatrix}
1 & 1
\end{pmatrix},\quad
b=\begin{pmatrix}
0
\end{pmatrix}.\]

初期点として
\[
x^{(0)} = (0,0)^\top
\]
を用い，スラック変数および双対変数は
\[
y^{(0)} = 1,\qquad \lambda^{(0)} = 1
\]
とした。これらはいずれも正であり，内点法の初期条件を満たしている。

この条件下で課題3のアルゴリズムをaddtask.pyに実装し，反復を行った。
以下が出力結果である。
\[
\mathbf{x}^* = \begin{pmatrix} -2.809 \times 10^{-13} \\ -5.618 \times 10^{-13} \end{pmatrix}
\]
\[
y = \begin{pmatrix} 8.427 \times 10^{-13} \end{pmatrix}
\]
\[
\lambda = \begin{pmatrix} 1.000 \end{pmatrix}
\]
\[
\text{info} = \{\text{iter}: 12,\ r_d: 3.140 \times 10^{-16},\ r_p: 4.039 \times 10^{-28},\ \mu: 8.427 \times 10^{-13}\}
\]

つまり,最適解は
\[x^* \approx \begin{pmatrix} 0 \\ 0 \end{pmatrix}\]
\[y \approx \begin{pmatrix} 0 \end{pmatrix}\]
\[\lambda \approx \begin{pmatrix} 1 \end{pmatrix}\]
であることがわかる。